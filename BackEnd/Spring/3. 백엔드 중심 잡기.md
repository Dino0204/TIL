# ë°±ì—”ë“œ ì¤‘ì‹¬ ì¡ê¸°

## 1. ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ì •ë¦¬

---

### ì£¼ìš” ê¸°ëŠ¥: íšŒì› ê´€ë¦¬

- ë°ì´í„°: íšŒì› ì•„ì´ë””, ì´ë¦„
- ê¸°ëŠ¥: íšŒì› ë“±ë¡, ì¡°íšŒ
- DB: ë¯¸ì„ ì •

### ì›¹ ê³„ì¸µ êµ¬ì¡°

![img](<ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ êµ¬ì¡°.png>)

> **ğŸ”´ì»¨íŠ¸ë¡¤ëŸ¬**
> ì‚¬ìš©ìì˜ ì…ë ¥ì— ëŒ€í•œ ì‘ë‹µìœ¼ë¡œ ëª¨ë¸(ë„ë©”ì¸) or ë·°ë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤.

> **ğŸ”µì„œë¹„ìŠ¤**
> í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ êµ¬í˜„í•˜ëŠ” íŒŒíŠ¸ì´ë‹¤.

> **ğŸŸ¢ë¦¬í¬ì§€í† ë¦¬**
> ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•˜ë©°, ë„ë©”ì¸ ê°ì²´ë¥¼ DBì— ì €ì¥ ë° ê´€ë¦¬ë¥¼ ìˆ˜í–‰í•œë‹¤.

> **âšªï¸ë„ë©”ì¸**
> ëª¨ë¸, ë¹„ì¦ˆë‹ˆìŠ¤ ê°ì²´ë¥¼ ëœ»í•œë‹¤.

> **ğŸŸ ì—”í‹°í‹°**
> ì‹¤ì œ DB í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ëŠ” í´ë˜ìŠ¤ì´ë‹¤.

### í´ë˜ìŠ¤ ì˜ì¡´ ê´€ê³„

- ì•„ì§ DBê°€ ì •í•´ì§€ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— DB ì„ ì • ì‹œ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ MemberRepository ëŒ€ì‹  ê°œë°œì„ ìœ„í•´ ë©”ëª¨ë¦¬ ê¸°ë°˜ DB(MemoryMemberRepository)ë¥¼ ì‚¬ìš©í•œë‹¤.

## 2. ë„ë©”ì¸ & ë¦¬í¬ì§€í† ë¦¬(íšŒì›)

---

### Member - ë„ë©”ì¸

ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ íšŒì›ì˜ ì•„ì´ë””ì™€ ì´ë¦„ì„ í•„ë“œì— ì§€ì •í•´ì¤€ë‹¤.
ë˜í•œ getter, setterë¡œ í•„ë“œê°’ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.

```java
  public class Member{
    private Long id;
    private String name;

    public Long getId() {
      return id;
    }

    public void setId(Long id) {
      this.id = id;
    }

    public String getName() {
      return name;
    }

    public void setName(String name) {
      this.name = name;
    }
  }

```

### MemberRepository - ì¸í„°í˜ì´ìŠ¤

ë©¤ë²„ ê°ì²´ë¥¼ ë¦¬í¬ì§€í† ë¦¬ì— ì €ì¥í•˜ëŠ” íšŒì› ë“±ë¡ ê¸°ëŠ¥, Id, Name, All 3ê°€ì§€ ë°©ë²•ìœ¼ë¡œ íšŒì›ì„ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ì„ Abstract Methodë¡œ ì„ ì–¸í•œë‹¤.(Abstract Methodê°€ ë¬´ì—‡ì¸ì§€ ëª¨ë¥¸ë‹¤ë©´ êµ¬ê¸€ë§ ã„±ã„±) ë§ˆì§€ë§‰ìœ¼ë¡œ Optionalì´ë¼ëŠ” ë˜í¼ í´ë˜ìŠ¤ë¼ëŠ” ë¶€ë¶„ì´ ë³´ì¼ ê²ƒì´ë‹¤. ì´ ë˜í¼ í´ë˜ìŠ¤ëŠ” null ì²˜ë¦¬ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ ì“°ëŠ”ë° ë‹¨ì¼ ìš”ì†Œì˜ Null íŒŒì•…ì„ í•˜ê¸° ìœ„í•´ ì“°ì¸ë‹¤.

```java
  public interface MemberRepository {
    Member save(Member member);
    Optional<Member> findById(Long id);
    Optional<Member> findByName(String name);
    List<Member> findAll();
}
```

### MemoryMemberRepository - ì„ì‹œ ë¦¬í¬ì§€í† ë¦¬

ì´ì œ ìœ„ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë©”ì†Œë“œë¥¼ êµ¬í˜„í•´ë³´ì. ì•„ë˜ êµ¬í˜„ëœ ì½”ë“œë¥¼ ë³´ë©´ storeë¼ëŠ” Map íƒ€ì…ì˜ í´ë˜ìŠ¤ ë³€ìˆ˜ê°€ ì €ì¥ì†Œ ì—­í•  ìˆ˜í–‰í•˜ë©°, sqeuenceëŠ” íšŒì› ì•„ì´ë””ë¥¼ ì˜ë¯¸í•˜ë©° ìë™ìœ¼ë¡œ ì¦ê°€í•˜ëŠ” Primary Key(ê¸°ë³¸í‚¤) ì—­í• ì„ í•œë‹¤.

findByName ë©”ì„œë“œëŠ” ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì˜¨ nameì„ íƒìƒ‰í•˜ëŠ”ë° streamì„ ì‚¬ìš©í•˜ì—¬ íƒìƒ‰í•œë‹¤.
streamì€ í•œë§ˆë””ë¡œ ì—¬ëŸ¬ ìë£Œê°€ ì €ì¥ë˜ì–´ ìˆëŠ” ê°ì²´ì—ì„œ ë‹¨ì¼ ê°ì²´ ë§ˆë‹¤ ì ‘ê·¼í•˜ê²Œ í•´ì£¼ëŠ” ë©”ì„œë“œë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤. ì•„ë¬´íŠ¼ ê·¸ í›„ filter ë©”ì„œë“œë¡œ ë§¤ê°œë³€ìˆ˜ë¡œ ë“¤ì–´ì˜¨ nameì„ ì €ì¥ì†Œì˜ íšŒì›ê³¼ ë¹„êµí•œ ë’¤ ì¼ì¹˜í•˜ëŠ” íšŒì›ì„ findAnyë¥¼ í†µí•˜ì—¬ ë°˜í™˜í•´ì¤€ë‹¤.

ì´ ì½”ë“œì—ì„œëŠ” ë™ì‹œì„± ë¬¸ì œê°€ ìˆë‹¤ê³  í•˜ëŠ”ë° ë‹¤ìŒì— ì•Œì•„ë³´ë„ë¡ í•˜ì.

```java
  public class MemoryMemberRepository implements MemberRepository{

    private static Map<Long, Member> store = new HashMap<>();  // ì €ì¥ì†Œ
    private static long sequence = 0L;  // íšŒì› ID

    @Override
    public Member save(Member member) {
        member.setId(++sequence);
        store.put(member.getId(), member);
        return member;
    }

    @Override
    public Optional<Member> findById(Long id) {
        return Optional.ofNullable(store.get(id));
    }

    @Override
    public Optional<Member> findByName(String name) {
        return store.values().stream()
                .filter(member -> member.getName().equals(name))
                .findAny();
    }

    @Override
    public List<Member> findAll() {
        return new ArrayList<>(store.values());
    }

    public void clearStore() {
        store.clear();
    }
  }
```

## 3. ì„œë¹„ìŠ¤

---

### MemberService - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„

ì„œë¹„ìŠ¤ ë¶€ë¶„ì€ Memberë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì‹¤ì§ˆì ì¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” íŒŒíŠ¸ì´ë‹¤.

```java
  @Service
  public class MemberService {

    private final MemberRepository memberRepository;

    public MemberService(MemberRepository memberRepository) {
        this.memberRepository = new MemoryMemberRepository();
    }

    /** íšŒì› ê°€ì… */
    public Long join(Member member) {
        // ì¤‘ë³µ íšŒì› ê²€ì¦
        validateDuplicateMember(member);
        memberRepository.save(member);
        return member.getId();
    }

    private void validateDuplicateMember(Member member) {
        memberRepository.findByName(member.getName())
                .ifPresent(m -> {
                    throw new IllegalStateException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
                });
    }

    /** ì „ì²´ íšŒì› ì¡°íšŒ */
    public List<Member> findMembers() {
        return memberRepository.findAll();
    }

    public Optional<Member> findOne(Long memberId) {
        return memberRepository.findById(memberId);
    }
  }

```

## 4. í™ˆê³¼ ë©¤ë²„ ë“±ë¡ & ì¡°íšŒ

---

### HomeController - í™ˆ

í´ë¼ì´ì–¸íŠ¸ê°€ '/' URLë¡œ ì ‘ê·¼ ì‹œ Home.htmlì„ í˜¸ì¶œí•˜ì—¬ í™ˆ í™”ë©´ì„ êµ¬ì„±í•œë‹¤.

```java
  @Controller
  public class HomeController {

    @GetMapping("/")
    public String home() {
        return "home";
    }
  }
```

### MemberForm - í´ë¼ì´ì–¸íŠ¸ ì…ë ¥ ê´€ë¦¬

í´ë¼ì´ì–¸íŠ¸ê°€ ì…ë ¥í•œ ë©¤ë²„ ì´ë¦„ì„ setterë¥¼ í†µí•˜ì—¬ ì„¤ì •í•´ì¤€ë‹¤.

```java
  public class MemberForm {
    private String name;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
  }
```

### MemberController - ë©¤ë²„ ë“±ë¡ & ì¡°íšŒ

ë§ˆì°¬ê°€ì§€ë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ í•´ë‹¹í•˜ëŠ” URLì— ì ‘ê·¼ ì‹œ GETìš”ì²­ì„ í†µí•˜ì—¬ HTMLì„ ë¶ˆëŸ¬ì˜¤ê³  MemberFormì„ í†µí•˜ì—¬ í•´ë‹¹í•˜ëŠ” ì´ë¦„ì„ getterë¡œ ê°€ì ¸ì˜¨ ë’¤ ì¤‘ë³µ íšŒì›ì¸ì§€ ì•„ë‹Œì§€ ê²€ì‚¬ í›„ MemoryMemberRepositoryì— ì €ì¥í•˜ê²Œ ëœë‹¤.

ë©¤ë²„ ì¡°íšŒ ë¶€ë¶„ì—ì„œëŠ” MemberServiceì—ì„œ ëª¨ë“  ë©¤ë²„ë¥¼ ì°¾ì•„ ë¦¬ìŠ¤íŠ¸ë¡œ ë§Œë“¤ì–´ HTMLì„ ë°˜í™˜í•´ì£¼ê²Œ ëœë‹¤.

```java
  @Controller
  public class MemberController {
    private final MemberService memberService;

    @Autowired
    public MemberController(MemberService memberService) {
        this.memberService = memberService;
    }

    @GetMapping("/members/new")
    public String createForm() {
        return "members/createMemberForm";
    }

    @PostMapping("/members/new")
    public String create(MemberForm memberForm) {
        Member member = new Member();
        member.setName(memberForm.getName());

        memberService.join(member);

        return "redirect:/";
    }

    @GetMapping("/members")
    public String list(Model model) {
        List<Member> members = memberService.findMembers();
        model.addAttribute("members", members);

        return "members/memberList";
    }
  }
```

## End. ë¦¬í¬ì§€í† ë¦¬ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±(íšŒì›)

---

ìœ„ ì½”ë“œì—ì„œ êµ¬í˜„í•œ ë¦¬í¬ì§€í† ë¦¬ ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œëŠ” í…ŒìŠ¤íŠ¸ë¥¼ í¸í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤. í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ëŒ€ê·œëª¨ì˜ ì„œë¹„ìŠ¤ì—ì„œëŠ” í•„ìˆ˜ì ì¸ ê³¼ì •ì´ë‹¤.
ë˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œ ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ë¥¼ ë™ì‹œì— ì§„í–‰í•˜ê¸° ì–´ë µê³  ì˜¤ë˜ ê±¸ë¦°ë‹¤ëŠ” ë‹¨ì ì´ ìˆëŠ”ë° ì´ë¥¼ JUnitì´ë¼ëŠ” í”„ë ˆì„ì›Œí¬ë¥¼ í†µí•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆë‹¤. í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰ í•  ë•Œì—ëŠ” ë…ë¦½ì ì¸ í™˜ê²½ì„ ì§€í‚¤ëŠ” ê²ƒì´ ì¢‹ë‹¤. í…ŒìŠ¤íŠ¸ê°„ì— ì˜ì¡´ê´€ê³„ê°€ ë°œìƒí•˜ë©´ ê²°ê³¼ì— í° í—ˆì ì´ ìƒê¸¸ ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— ê±¸ë§ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•œ í›„ ì–´ë…¸í…Œì´ì…˜ì¸ @Testë¥¼ ë¶™ì´ë©´ ëœë‹¤.
í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ ë¬´ì—‡ì„ í…ŒìŠ¤íŠ¸ í•´ì•¼í• ì§€ ëª¨ë¥´ê² ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•˜ë©´ í¸í•˜ë‹¤ê³  í•œë‹¤.

- **//given**: ì¤€ë¹„ - í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ê³¼ì •(í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•˜ëŠ” ë³€ìˆ˜, ì…ë ¥ ê°’ ì •ì˜)
- **//when**: ì‹¤í–‰ - ì‹¤ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ê³¼ì •
- **//then**: ê²€ì¦ - í…ŒìŠ¤íŠ¸ë¥¼ ê²€ì¦í•˜ëŠ” ê³¼ì •(ì˜ˆìƒ ê°’ê³¼ ì‹¤ì œ ì‹¤í–‰ ê°’ì„ ë¹„êµ)

ğŸŸ¢ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì„±ê³µ ì‹œ
ğŸ”´ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‹¤íŒ¨ ì‹œ: ê¸°ëŒ€ê°’ê³¼ ì‹¤ì œê°’ì˜ ì°¨ì´ì ì„ ì•Œë ¤ì¤€ë‹¤.
