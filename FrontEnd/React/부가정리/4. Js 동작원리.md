## 개념

---

- 싱글스레드로 동작하는 언어
  → 하나의 메인스레드와 콜스택을 가지고 있기 때문이다.

## 스레드란?

---

- 개념 : 프로세스에 할당받은 자원으로 작업을 담당하는 실행의 최소단위

### 싱글스레드

- 개념 : 하나의 프로세스당 하나의 스레드를 실행함
- 하나의 레지스터, 스택으로 표현함 (Memory Heap , Call Stack)

- 참고

  > 프로세스 : 프로그램를 실행시켰을 때 상태

- 싱글 스레드 : 순차 실행
- 멀티 스레드 : 병행 실행
  - 컨텍스트 스위칭 (Context Switching) : 스레드 → 스레드로 이동하며 일어남 , 부분적으로 각각의 스레드에 대한 작업을 수행함 → 이 과정이 빠르게 일어나면서 동시에 수행되는 것처럼 보임

## 자바스크립트 엔진 (V8)

---

### Memory Heap

- 정의 : 프로그램에서 동적으로 할당된 메모리를 관리하는 영역
- 특징
  - 데이터의 크기를 미리 예측하기 어려울 때 유용함
  - 동적으로 메모리를 할당하기 때문에 메모리 누수에 주의해야 함

### Call Stack (단일 호출 스택)

- 정의 : 지역 변수와 함수 호출 시 생성되는 변수들을 저장하는 영역

### 동작 방식

- 자바스크립트 엔진은 각각 하나의 Memory Heap , Call Stack을 가지고 있음 → 한번에 하나의 함수만 동기적으로 실행가능(메인스레드에서 호출되는 함수들이 Call Stack에 쌓여 LIFO방식으로 실행)
- 특징
  - 비동기 처리를 지원함 → ??? 라고 생각할 수 있음
  - Web API, Task Queue, Event Loop가 외부에서 실행에 관여하여 비동기 처리를 실행할 수 있음

### 자바스크립트 런타임

- Web API
  - 비동기 작업 수행
  - CallBack을 CallBack Queue로 전달
- CallBack Queue
  - 넘겨받은 값 저장
- Event Loop
  - Call Stack Empty 판단
  - CallBack Queue 작업을 Call Stack으로 옮김

### 요약 [JS Runtime 동작 순서] (CallBack 패턴)

1. CallBack Stack에 함수가 LIFO순서로 쌓여서 실행됨
2. CallBack 함수가 함수 내에 있을 때
   1. JS 내부에서 실행 가능 하면 CallBack Stack에 쌓음
   2. JS 내부에서 실행 불가능하면 Web API에게 위임
3. Web API가 비동기 API 실행 후 CallBack 함수 CallBack Queue에 삽입
4. Event Loop가 CallStack이 비었는지 판단해서 CallBack Queue → CallStack으로 CallBack 함수를 넣어줌
5. CallStack에 올라간 CallBack 함수는 pop되어 실행됨

## 참고자료

- [https://another-day.tistory.com/entry/힙-메모리Heap-Memory](https://another-day.tistory.com/entry/%ED%9E%99-%EB%A9%94%EB%AA%A8%EB%A6%ACHeap-Memory)
- [https://hi-zini.tistory.com/entry/JavaScript-동작원리](https://hi-zini.tistory.com/entry/JavaScript-%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC)
